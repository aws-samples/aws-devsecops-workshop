<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<html lang="en" class="js csstransforms3d">
<head>
  <meta charset="utf-8">
  <meta property="og:title" content="DevSecOps on AWS" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="generator" content="Hugo 0.78.1" />
  <meta name="description" content="DevSecOps on AWS">
<meta name="author" content="Eduardo Janicas">

  <link rel="shortcut icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />
<link rel="icon" href="https://a0.awsstatic.com/libra-css/images/site/fav/favicon.ico" type="image/ico" />

  <title>Testing a Template :: DevSecOps on AWS</title>

  
  <link href="./css/nucleus.css" rel="stylesheet">
  <link href="./css/fontawesome-all.min.css" rel="stylesheet">
  <link href="./css/hybrid.css" rel="stylesheet">
  <link href="./css/featherlight.min.css" rel="stylesheet">
  <link href="./css/perfect-scrollbar.min.css" rel="stylesheet">
  <link href="./css/auto-complete.css" rel="stylesheet">
  <link href="./css/atom-one-dark-reasonable.css" rel="stylesheet">
  <link href="./css/theme.css" rel="stylesheet">
  <link href="./css/hugo-theme.css" rel="stylesheet">
  
  <link href="./css/theme-aws.css" rel="stylesheet">
  

  <script src="./js/jquery-3.3.1.min.js"></script>

  <style>
    :root #header + #content > #left > #rlblock_left{
        display:none !important;
    }
    
      :not(pre) > code + span.copy-to-clipboard {
          display: none;
      }
    
  </style>
  
</head>

<body class="" data-url="./taskcat.html">
  <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <div>
    <a href="./" title="Go home">
        <img style="vertical-align:middle" src="./images/logo.png" height="70px" />
    </a>
</div>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="./js/lunr.min.js"></script>
<script type="text/javascript" src="./js/auto-complete.js"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="./js/search.js"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/introduction.html" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="./introduction.html">
          <b> </b>Introduction
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/clone.html" title="Clone Repository" class="dd-item 
        
        
        
        ">
      <a href="./clone.html">
          <b></b>Clone Repository
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/secrets.html" title="Store Secrets" class="dd-item 
        
        
        
        ">
      <a href="./secrets.html">
          <b> </b>Store Secrets
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/launch.html" title="Launch Stacks" class="dd-item 
        
        
        
        ">
      <a href="./launch.html">
          <b> </b>Launch Stacks
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/validate.html" title="Validating a Template" class="dd-item 
        
        
        
        ">
      <a href="./validate.html">
          <b> </b>Validating a Template
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cfn-nag.html" title="Linting a Template" class="dd-item 
        
        
        
        ">
      <a href="./cfn-nag.html">
          <b> </b>Linting a Template
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/taskcat.html" title="Testing a Template" class="dd-item 
        parent
        active
        
        ">
      <a href="./taskcat.html">
          <b> </b>Testing a Template
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/config.html" title="Enforcing Compliance" class="dd-item 
        
        
        
        ">
      <a href="./config.html">
          <b> </b>Enforcing Compliance
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/config/soak.html" title="Soak Testing Environment" class="dd-item 
        
        
        
        ">
      <a href="./config/soak.html">
          <b> </b>Soak Testing Environment
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/config/works.html" title="How AWS Config Works" class="dd-item 
        
        
        
        ">
      <a href="./config/works.html">
          <b> </b>How AWS Config Works
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/config/rules.html" title="Evaluating Resources with Rules" class="dd-item 
        
        
        
        ">
      <a href="./config/rules.html">
          <b> </b>Evaluating Resources with Rules
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/conclusion.html" title="Conclusion and Clean Up" class="dd-item 
        
        
        
        ">
      <a href="./conclusion.html">
          <b> </b>Conclusion and Clean Up
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <left>

    <h5 class="copyright">&copy; 2020 Amazon Web Services, Inc. or its Affiliates. All rights reserved.<h5>

</left>

    </section>
  </div>
</nav>





  <section id="body">
    <div id="overlay"></div>
    <div class="padding highlightable">
      
      <div>
        <div id="top-bar">
          
          
          
          
          <div id="top-github-link">
            <a class="github-link" title='Edit this page' href="https://github.com/aws-samples/aws-devsecops-workshop/tree/master/workshop/content/taskcat/_index.md"
              target="blank">
              <i class="fas fa-code-branch"></i>
              <span id="top-github-link-text">Edit this page</span>
            </a>
          </div>
          
          
          
          <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                <i class="fa fa-bars"></i>
              </a>
            </span>
            
            <span class="links">
              
          
          
          
          
          
          
          <a href='./'>DevSecOps on AWS</a> > Testing a Template
          
          
          
          
            </span>
          </div>
          
        </div>
      </div>
      

      
      <div id="chapter">
        
        <div id="body-inner">
          <h1>Testing a Template</h1>
          
          



	<p>The vpc ID <code>default-vpc</code> on <code>wordpress/wordpress-single-instance.yaml</code> line 145 does not exist. If we ommit the security group on a CloudFormation template it will default to the default VPC, so let&rsquo;s do exactly that. Delete line 145 all together to get the following security group:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">WebServerSecurityGroup:
  Type: AWS::EC2::SecurityGroup
  Properties:
    GroupDescription: <span style="color:#e6db74">&#34;Enable HTTP access via port 80 locked down to the load balancer + SSH access&#34;</span>
    SecurityGroupIngress:
      - CidrIp: 0.0.0.0/0
        FromPort: <span style="color:#ae81ff">80</span>
        IpProtocol: tcp
        ToPort: <span style="color:#ae81ff">80</span>
</code></pre></div><p>And commit and push the changes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git add wordpress/wordpress-single-instance.yaml
git commit -m <span style="color:#e6db74">&#34;Removed default-vpc on the SG&#34;</span>  
git push AWSCodeCommit master
</code></pre></div><p><a href="https://github.com/aws-quickstart/taskcat">TaskCat</a> is a tool that tests AWS CloudFormation templates. It deploys your AWS CloudFormation template in multiple AWS Regions and generates a report with a pass/fail grade for each region. You can specify the regions and number of Availability Zones you want to include in the test, and pass in parameter values from your AWS CloudFormation template. taskcat is implemented as a Python class that you import, instantiate, and run.</p>
<p><img src="https://raw.githubusercontent.com/aws-quickstart/taskcat/master/assets/docs/images/logo.png" alt="Taskcat"></p>
<p>Taskcat uses two configuration files: <strong>Global config</strong> and <strong>Project config</strong>. The global config file provides global settings that become defaults for all projects. It is located in userâ€™s home-directory <code>~/.taskcat.yml</code>. The project config file provides project-specific configurations. The project config file is located in the root of your project folder <code>&lt;PROJECT_ROOT&gt;/.taskcat.yml</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">project</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">wordpress-single-instance</span>
  <span style="color:#f92672">regions</span>:
    - <span style="color:#ae81ff">eu-west-1</span>
<span style="color:#f92672">tests</span>:
  <span style="color:#f92672">default</span>:
    <span style="color:#f92672">template</span>: <span style="color:#ae81ff">wordpress/wordpress-single-instance.yaml</span>
</code></pre></div><p>TaskCat performs multiple actions, such as template validation, parameter validation, and staging content into an Amazon Simple Storage Service (Amazon S3) bucket, before launching the AWS CloudFormation stack. It launches the stack in the defined Regions, simultaneously. And it regularly polls the AWS CloudFormation stack status to check if the stack creation is finished. After the stack has been successfully created, TaskCat deletes it. How much time TaskCat takes to finish the testing depends on how many tests you have defined in your TaskCat configuration file and how long each stack creation and deletion takes. After the TaskCat run is completed, it generates a report in HTML format in the directory from where you are running the TaskCat command.</p>

<div class="notices tip" ><p>Parameter Overrides were added to the taskcat to solve a couple of common problems. First, many templates share common parameters that are unique to an AWS account, like a KeyPair name or an S3 Bucket, overrides provided a way to store those centrally for all your projects. Second, we didnâ€™t want to add sensitive data (usernames, passwords, tokens) to a git repository. The idea was to store sensitive/unique data outside of a git repository, but still execute a test using this data. To that end, any parameter defined in the global config will take precedence over the same parameter in a project-level config.</p>
</div>

<p><img src="./images/soaktest.png" alt="soaktest"></p>
<p>The stack is now waiting for manual approval and an email on your inbox asking for it. However, we received another email from AWS Config. It says:</p>
<pre><code class="language-none" data-lang="none">A Config rule is not compliant in your environment. Please open the Config Dashboard for further details.
</code></pre>




<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="./cfn-nag.html" title="Linting a Template"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="./config.html" title="Enforcing Compliance" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="./js/clipboard.min.js"></script>
    <script src="./js/perfect-scrollbar.min.js"></script>
    <script src="./js/perfect-scrollbar.jquery.min.js"></script>
    <script src="./js/jquery.sticky.js"></script>
    <script src="./js/featherlight.min.js"></script>
    <script src="./js/html5shiv-printshiv.min.js"></script>
    <script src="./js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="./js/modernizr.custom-3.6.0.js"></script>
    <script src="./js/learn.js"></script>
    <script src="./js/hugo-learn.js"></script>

    <link href="./mermaid/mermaid.css" rel="stylesheet" />
    <script src="./mermaid/mermaid.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    
  </body>
</html>
